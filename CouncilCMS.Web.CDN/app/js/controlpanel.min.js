function bsAdmin(){}bsAdmin.editMap;bsAdmin.editMapMarkers;bsAdmin.galleryUploader;bsAdmin.processingTimer;bsAdmin.divPreview;bsAdmin.divRowEdit;bsAdmin.divColumnEdit;bsAdmin.divContentEdit;bsAdmin.divProcessing;$(document).ready(function(){$(document).on("click",".preview-content",function(n){n.preventDefault();$("body").modalmanager("loading");var t=$(this).data("id"),i=$(this).data("type");bsAdmin.divPreview.find(".modal-body").load("/uk/controlpanel/ajax/PreviewContent/",{itemid:t,type:i},function(){bsAdmin.divPreview.modal({backdrop:"static",keyboard:!1,modalOverflow:!0});coreUtils.createPage(bsAdmin.divPreview.find(".modal-body"))})});$(document).on("click",".edit-content-row",function(){$("body").modalmanager("loading");var n=$(this).data("id");bsAdmin.divRowEdit.find(".modal-body").load("/uk/controlpanel/ajax/GetContentRowEditForm/",{id:n},function(){bsAdmin.divRowEdit.modal({backdrop:"static",keyboard:!1})})});$(document).on("click",".edit-content-column",function(){$("body").modalmanager("loading");var n=$(this).data("id");bsAdmin.divColumnEdit.find(".modal-body").load("/uk/controlpanel/ajax/GetContentColumnEditForm/",{id:n},function(){bsAdmin.divColumnEdit.modal({backdrop:"static",keyboard:!1})})});$(document).on("click",".add-row",function(){$("body").modalmanager("loading");var n=$(this).data("item-id"),t=$(this).data("type");bsAdmin.divRowEdit.find(".modal-body").load("/uk/controlpanel/ajax/GetRowSelect/",{itemId:n,type:t},function(){bsAdmin.divRowEdit.modal({backdrop:"static",keyboard:!1,modalOverflow:!0})})});$(document).on("click",".add-content",function(){$("body").modalmanager("loading");var n=$(this).data("col-id"),t=$(this).data("position");bsAdmin.divContentEdit.find(".modal-body").load("/uk/controlpanel/ajax/GetContentSelect/",{contentcolumnid:n,position:t},function(){bsAdmin.divContentEdit.modal({backdrop:"static",keyboard:!1,modalOverflow:!0})})});$(document).on("click",".edit-content",function(){$("body").modalmanager("loading");var n=$(this).data("id");bsAdmin.divContentEdit.find(".modal-body").load("/uk/controlpanel/ajax/GetContentEditForm/",{id:n},function(){bsAdmin.divContentEdit.modal({backdrop:"static",keyboard:!1,modalOverflow:!0});bsAdmin.createEditMap();bsAdmin.createEditGallery()})});$(document).on("click",".select-row",function(){var n=$(this).data("item-id"),t=$(this).data("type"),i=$(this).data("col-type");bsAdmin.divRowEdit.modal("hide");bsAdmin.startProcessing();$.post("/uk/controlpanel/ajax/addcontentrow/",{itemId:n,type:t,colType:i},function(n){bsAdmin.endProcessing();$("#divRows").append(n)})});$(document).on("click",".select-content",function(){var n=$(this).data("col-id"),t=$(this).data("type");bsAdmin.divContentEdit.find(".modal-body").load("/uk/controlpanel/ajax/GetContentEditForm/",{id:0,contentcolumnid:n,type:t},function(){coreUtils.createForm(bsAdmin.divContentEdit.find("form[data-ajax='true']"));bsAdmin.divContentEdit.find(".loading-mask").remove();bsAdmin.createEditMap();bsAdmin.createEditGallery()})});$(document).on("click",".close-content-edit",function(){bsAdmin.divContentEdit.modal("hide")});$(document).on("click",".move-content-row",function(){var r=$(this).data("id"),i=parseInt($(this).data("direction")),t=$("#row"+r),n=i>0?t.next():t.prev();n&&n.hasClass("row-item")&&t.animate({top:i*50},200,function(){n.animate({top:-i*50},200,function(){$.post("/uk/controlpanel/ajax/movecontentrow",{id:r,neighbourId:n.attr("id").substring(3),direction:i>0?"down":"up"},function(){t.css("top","0px");n.css("top","0px");t.insertBefore(n)})})})});$(document).on("click",".move-content",function(){var r=$(this).data("id"),i=parseInt($(this).data("direction")),t=$("#content"+r),n=i>0?t.next():t.prev();n&&n.hasClass("content-item")&&t.animate({top:i*30},200,function(){n.animate({top:-i*30},200,function(){$.post("/uk/controlpanel/ajax/movecontent",{id:r,neighbourId:n.attr("id").substring(7),direction:i>0?"down":"up"},function(){t.css("top","0px");n.css("top","0px");i>0?t.insertAfter(n):t.insertBefore(n)})})})});$(document).on("click",".remove-content-row",function(){if($(this).addClass("disabled").find(".fa").removeClass("fa-trash").addClass("fa-circle-o-notch fa-spin"),confirm("Увага! Весь контент цього блоку буде видалено. Ви впевнені, що хочете продовжити?")){var t=$(this).parents(".content-edit").data("type"),n=$(this).data("id"),i=$(this).data("item-id");$.post("/uk/controlpanel/ajax/removecontentrow",{id:n,itemid:i,type:t},function(){$("#row"+n).slideUp(300,function(){$(this).empty().remove()})})}else $(this).removeClass("disabled").find(".fa").addClass("fa-trash").removeClass("fa-circle-o-notch fa-spin")});$(document).on("click",".remove-content",function(){if($(this).prop("disabled",!0).addClass("disabled").find(".fa").removeClass("fa-trash").addClass("fa-circle-o-notch fa-spin"),confirm("Увага! Контент буде видалено без можливості відновлення. Ви впевнені, що хочете продовжити?")){var n=$(this).data("id");$.post("/uk/controlpanel/ajax/removecontent",{id:n},function(){$("#content"+n).slideUp(300,function(){$(this).empty().remove()});bsAdmin.divContentEdit.modal("hide")})}else $(this).prop("disabled",!1).removeClass("disabled").find(".fa").addClass("fa-trash").removeClass("fa-circle-o-notch fa-spin")});$(document).on("click","#btnMapZoomPlus",function(){var n=parseInt($("#tbMapZoom").val())+1;n<=20&&(bsAdmin.editMap.setZoom(n),$("#tbMapZoom").val(n))});$(document).on("click","#btnMapZoomMinus",function(){var n=parseInt($("#tbMapZoom").val())-1;n>=2&&(bsAdmin.editMap.setZoom(n),$("#tbMapZoom").val(n))});$(document).on("click","#btnMapHeightPlus",function(){var n=parseInt($("#tbMapHeight").val())+20;$("#divContentMap").css({height:n});$("#tbMapHeight").val(n);google.maps.event.trigger(bsAdmin.editMap,"resize")});$(document).on("click","#btnMapHeightMinus",function(){var n=parseInt($("#tbMapHeight").val())-20;n>=20&&($("#divContentMap").css({height:n}),$("#tbMapHeight").val(n),google.maps.event.trigger(bsAdmin.editMap,"resize"))});$(document).on("click","#btnAddMarker",function(){bsAdmin.addEditMarker(undefined,undefined,undefined,!0)});$(document).on("click","#btnSaveMarker",function(){var u,n=$("#hMarkerId").val(),f=$("#divFindMarker"),e=$("#divSaveMarker"),t=$("#divMapEditMarkers").find("#marker"+n),i,r;for(titleUk=$("#tbMarkerTitleUk").val(),titleRu=$("#tbMarkerTitleRu").val(),titleEn=$("#tbMarkerTitleEn").val(),descUk=$("#tbMarkerDescUk").val(),descRu=$("#tbMarkerDescRu").val(),descEn=$("#tbMarkerDescEn").val(),t.find("input[name='MapPoints["+n+"].TitleUk']").val(titleUk),t.find("input[name='MapPoints["+n+"].TitleRu']").val(titleRu),t.find("input[name='MapPoints["+n+"].TitleEn']").val(titleEn),t.find("input[name='MapPoints["+n+"].DescriptionUk']").val(descUk),t.find("input[name='MapPoints["+n+"].DescriptionRu']").val(descRu),t.find("input[name='MapPoints["+n+"].DescriptionEn']").val(descEn),i=0;i<bsAdmin.editMapMarkers.length;i++)bsAdmin.editMapMarkers[i].id==n&&(u=bsAdmin.editMapMarkers[i]);r=new google.maps.InfoWindow;r.setContent(descUk);r.open(bsAdmin.editMap,u);f.collapse("show");e.collapse("hide")});$(document).on("click",".gallery-edit-item-edit",function(){var n=$(this).data("id"),t=$("input[name='GalleryItems["+n+"].Image']").val();coreUtils.showCropModal(t,0,0,!1,function(t){$("input[name='GalleryItems["+n+"].Image']").val(t.path);$("#galleryEditItemImg"+n).attr("src",t.path)})});$(document).on("click",".gallery-edit-item-del",function(){var n=$(this).data("id");$("#galleryEditItem"+n).empty().remove()})});bsAdmin.createEditMap=function(){if($("#formMapEdit").length>0){var n=new google.maps.places.SearchBox($("#tbAddMarkerByPlace")[0]);bsAdmin.editMapMarkers=[];bsAdmin.editMap=new google.maps.Map($("#divContentMap")[0],{zoom:parseInt($("#tbMapZoom").val()),center:{lat:parseFloat($("#hCenterLat").val().replace(",",".")),lng:parseFloat($("#hCenterLng").val().replace(",","."))},zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,scrollwheel:!1});google.maps.event.addListener(bsAdmin.editMap,"dragend",function(){var n=bsAdmin.editMap.getCenter();$("#hCenterLat").val(n.lat().toString().replace(".",","));$("#hCenterLng").val(n.lng().toString().replace(".",","))});google.maps.event.addListener(n,"places_changed",function(){var i=n.getPlaces()[0],t=i.geometry.location;bsAdmin.editMap.setCenter(t);bsAdmin.addEditMarker(undefined,t.lat(),t.lng(),!0)});$("#divMapEditMarkers > .map-edit-marker").each(function(){var n=$(this).find("input[name='MapPoints.Index']").val(),t=parseFloat($(this).find("input[name='MapPoints["+n+"].Lat']").val().replace(",",".")),i=parseFloat($(this).find("input[name='MapPoints["+n+"].Lng']").val().replace(",",".")),r=$(this).find("input[name='MapPoints["+n+"].TitleUk']").val(),u=$(this).find("input[name='MapPoints["+n+"].TitleRu']").val(),f=$(this).find("input[name='MapPoints["+n+"].TitleEn']").val(),e=$(this).find("input[name='MapPoints["+n+"].DescriptionUk']").val(),o=$(this).find("input[name='MapPoints["+n+"].DescriptionRu']").val(),s=$(this).find("input[name='MapPoints["+n+"].DescriptionEn']").val();bsAdmin.addEditMarker(n,t,i,!1,u,r,f,o,e,s)})}};bsAdmin.addEditMarker=function(n,t,i,r,u,f,e,o,s,h){n=n||coreUtils.randomId(20,".map-edit-marker > input","value");t=t||bsAdmin.editMap.getCenter().lat();i=i||bsAdmin.editMap.getCenter().lng();r=r;o=o||"";s=s||"";h=h||"";u=u||"Новый маркер";f=f||"Новий маркер";e=e||"New marker";var c=new google.maps.Marker({position:{lat:t,lng:i},title:f,map:bsAdmin.editMap,draggable:!0,id:n});$("#marker"+n).length==0&&$("#divMapEditMarkers").append("<div class='map-edit-marker' id='marker"+n+"'><input type='hidden' name='MapPoints.Index' value='"+n+"' /><input type='hidden' name='MapPoints["+n+"].Lat' value='"+t+"' /><input type='hidden' name='MapPoints["+n+"].Lng' value='"+i+"' /><input type='hidden' name='MapPoints["+n+"].TitleUk' value='"+f+"' /><input type='hidden' name='MapPoints["+n+"].TitleRu' value='"+u+"' /><input type='hidden' name='MapPoints["+n+"].TitleEn' value='"+e+"' /><input type='hidden' name='MapPoints["+n+"].DescriptionUk' value='"+s+"' /><input type='hidden' name='MapPoints["+n+"].DescriptionRu' value='"+o+"' /><input type='hidden' name='MapPoints["+n+"].DescriptionEn' value='"+h+"' /><\/div>");c.addListener("click",function(){bsAdmin.showMarkerForm(n)});c.addListener("dragend",function(){var t=c.getPosition();$("input[name='MapPoints["+n+"].Lat']").val(t.lat().toString().replace(".",","));$("input[name='MapPoints["+n+"].Lng']").val(t.lng().toString().replace(".",","))});bsAdmin.editMapMarkers.push(c);r&&bsAdmin.showMarkerForm(n)};bsAdmin.showMarkerForm=function(n){var r=$("#divFindMarker"),i=$("#divSaveMarker"),t=$("#divMapEditMarkers").find("#marker"+n),u=t.find("input[name='MapPoints["+n+"].TitleUk']").val(),f=t.find("input[name='MapPoints["+n+"].TitleRu']").val(),e=t.find("input[name='MapPoints["+n+"].TitleEn']").val(),o=t.find("input[name='MapPoints["+n+"].DescriptionUk']").val(),s=t.find("input[name='MapPoints["+n+"].DescriptionRu']").val(),h=t.find("input[name='MapPoints["+n+"].DescriptionEn']").val();CKEDITOR.instances.tbMarkerDescUk.setData(o);CKEDITOR.instances.tbMarkerDescRu.setData(s);CKEDITOR.instances.tbMarkerDescEn.setData(h);i.find("#tbMarkerTitleUk").val(u);i.find("#tbMarkerTitleRu").val(f);i.find("#tbMarkerTitleEn").val(e);i.find("#hMarkerId").val(n);r.collapse("hide");i.collapse("show")};bsAdmin.createEditGallery=function(){if($("#divGalleryEditItems").length>0){$("#divGalleryEditItems > .gallery-edit-item").each(function(){var n=$(this).find("input[name='GalleryItems.Index']").val(),t=$(this).find("input[name='GalleryItems["+n+"].Image']").val(),i=$(this).find("input[name='GalleryItems["+n+"].TitleUk']").val(),r=$(this).find("input[name='GalleryItems["+n+"].TitleRu']").val(),u=$(this).find("input[name='GalleryItems["+n+"].TitleEn']").val();bsAdmin.addGalleryItem(n,t,i,r,u)});var n=$(".gallery-edit-upload");bsAdmin.galleryUploader=n.uploader({url:"/api/upload/uploadfile?type=image&directory=doc_files",browseButton:n.find(".btn")[0],container:n.find("div")[0],dropElement:n.find("div")[0],chunk:"200kb",onAdd:function(n){coreUtils.disableButton($("#btnUploadGalleryItems"));n.start()},onUpload:function(n,t,i){if(i&&i.status==200){var r=$.parseJSON(i.response);bsAdmin.addGalleryItem(undefined,r.path);n.removeFile(t);n.files.length==0&&(coreUtils.enableButton($("#btnUploadGalleryItems")),n.refresh())}else return coreUtils.enableButton($("#btnUploadGalleryItems")),alert("File upload error")},onError:function(){return alert("File upload error")}})[0];Sortable.create($(".gallery-edit-items")[0],{handle:"img",animation:150})}};bsAdmin.addGalleryItem=function(n,t,i,r,u){n=n||coreUtils.randomId(20,".gallery-item-edit > input","value");i=i||"";r=r||"";u=u||"";$("#galleryEditItem"+n).length==0&&$("#divGalleryEditItems").append("<div class='gallery-edit-item card-sm' id='galleryEditItem"+n+"'><input type='hidden' name='GalleryItems.Index' value='"+n+"' /><input type='hidden' name='GalleryItems["+n+"].Image' value='"+t+"' /><div class='div-table'><div class='div-cell gallery-edit-item-img' style='width:120px;height:120px;'><img class='img' id='galleryEditItemImg"+n+"' src='"+t+"' /><\/div><div class='div-cell'><div class='form-group'><div class='lang-uk'><label class='control-label'>Підпис фото (ua)<\/label><input type='text' class='form-control' placeholder='Підпис фото (ua)' name='GalleryItems["+n+"].NameUk' value='"+i+"' /><\/div><div class='lang-ru'><label class='control-label'>Підпис фото (ru)<\/label><input type='text' class='form-control' placeholder='Підпис фото (ru)' name='GalleryItems["+n+"].NameRu' value='"+r+"' /><\/div><div class='lang-en'><label class='control-label'>Підпис фото (en)<\/label><input type='text' class='form-control' placeholder='Підпис фото (en)' name='GalleryItems["+n+"].NameEn' value='"+u+"' /><\/div><\/div><div class='text-right'><a href='"+t+"' target='_blank' class='link-btn' title='переглянути зображення'><i class='fa fa-fw fa-eye'><\/i><\/a><span class='link-btn gallery-edit-item-edit' data-id='"+n+"' title='редагувати зображення'><i class='fa fa-fw fa-pencil'><\/i><\/span><span class='link-btn gallery-edit-item-del' data-id='"+n+"' title='видалити зображення'><i class='fa fa-fw fa-trash'><\/i><\/span><\/div><\/div><\/div><\/div>")};bsAdmin.startProcessing=function(){clearTimeout(bsAdmin.processingTimer);bsAdmin.divProcessing.animate({height:window.innerHeight},300)};bsAdmin.endProcessing=function(){clearTimeout(bsAdmin.processingTimer);bsAdmin.processingTimer=setTimeout(function(){bsAdmin.divProcessing.animate({height:0},200,function(){$("button[type='submit']").prop("disabled",!1)})},100)};$(document).ready(function(){$.fn.modal.defaults.spinner=$.fn.modalmanager.defaults.spinner='<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="progress-bar" style="width: 100%;"><\/div><\/div><\/div>';$(document).on("closed",".remodal-form",function(){$(this).find(".remodal-content").empty()});$(document).on("opened",".remodal-form",function(){coreUtils.createForm($(this).find("form[data-ajax='true']"))});$(document).on("show.bs.modal",".modal",function(){coreUtils.createForm($(this).find("form[data-ajax='true']"))});$(document).on("hide.bs.modal",".modal",function(){$(this).find(".modal-body").empty()});$(document).on("show.bs.dropdown",".table-responsive",function(){$(".table-responsive").css("overflow","inherit")});$(document).on("hide.bs.dropdown",".table-responsive",function(){$(".table-responsive").css("overflow","auto")});$(document).on("click",".back-to-list",function(){window.createListState();window.pushState()});$(document).on("click",".no-event",function(n){n.preventDefault()});$(document).on("click",".input-clear",function(){var n=$(this).parents(".input-group").find(".form-control");n.prop("readonly",n.hasClass("bs-select")?!0:!1).val("");n.data("related-element")&&$(n.data("related-element")).val("");n.hasClass("bs-autocomplete")&&coreUtils.createAutocomplete(n);n.each(function(){$(this).hasClass("ac-value")&&coreUtils.createAutocompleteSelect($(this))})});$(document).on("change","input[type='checkbox'][data-toggle='show']",function(){var n=$(this).data("target");$(this).is(":checked")?$(n).slideDown():$(n).slideUp()});$(document).on("click",".btn-remove-relateditem",function(){var n=$(this),t=$(n.parents(".related-items"));n.parents(".related-item").remove();coreUtils.refreshListIndexes(t)});$(document).on("submit","form",function(n){coreUtils.disableButton($(this).find("button[type='submit'], input[type='submit']"));$(this).validate({ignore:".ignore"});try{if($(this).valid())try{return validFormBeforeSend(n)}catch(t){}else return coreUtils.enableButton($(this).find("button[type='submit'], input[type='submit']")),n.preventDefault(),!1}catch(t){}});$("form").submit(function(n){if($(this).hasClass("disabled"))return n.preventDefault(),!1});$(".bs-select").each(function(){coreUtils.createSelect($(this))});$(".upload-panel").each(function(){coreUtils.createUploader($(this))});$(".bs-datepicker").each(function(){coreUtils.createDatepicker($(this))});$(".bs-daterangepicker").each(function(){coreUtils.createDaterangepicker($(this))});$(".bs-colorpicker").each(function(){coreUtils.createColorpicker($(this))});$(".bs-autocomplete").each(function(){coreUtils.createAutocomplete($(this))});$(".bs-autocompleteselect").each(function(){coreUtils.createAutocompleteSelect($(this))});$(".bs-ckeditor").each(function(){coreUtils.createCkeditor($(this))});$(".bs-mask").each(function(){coreUtils.createMask($(this))});$(".bs-map").each(function(){coreUtils.createPlaceMap($(this))})});